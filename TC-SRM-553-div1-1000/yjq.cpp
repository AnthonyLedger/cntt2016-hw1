#include<bits/stdc++.h>
using namespace std;typedef long long LL;int n;const int MAXN=60;vector<pair<int,pair<LL,LL>>>hed[MAXN];void addedge(int u,int v,int x,int y){hed[u].push_back(make_pair(v,pair<LL,LL>(x,y)));}pair<LL,LL>nd[MAXN];LL d[MAXN];int calc(LL an,vector<int>&s2,vector<int>&t2,vector<int>&l2,vector<int>&s1,vector<int>&t1,vector<int>&l1){for(int i=0;i<=n;i++)hed[i].clear();addedge(0,n,0,1),addedge(n,0,0,-1);for(int i=0;i<n;i++)addedge(i+1,i,-1,0);for(int i=0;i<s1.size();i++){int s=s1[i],t=t1[i],l=l1[i];if(s<t)addedge(s,t,l,0);else addedge(s,t,l,-1);}for(int i=0;i<s2.size();i++){int s=s2[i],t=t2[i],l=l2[i];if(s<t)addedge(t,s,-l,0);else addedge(t,s,-l,1);}int edge_cnt=0;for(int i=0;i<=n;i++)edge_cnt+=hed[i].size();d[0]=0,nd[0]=pair<LL,LL>(0,0);for(int i=1;i<=n;i++)d[i]=(1LL<<60);bool update;pair<LL,LL>fin;for(int turn=0;turn<n*n;turn++){update=0;for(int i=0;i<=n;i++)if(d[i]<(1LL<<60))for(int j=0;j<hed[i].size();j++){int v=hed[i][j].first;LL ndis=d[i]+hed[i][j].second.first+an*1LL*hed[i][j].second.second;if(ndis<d[v]){d[v]=ndis,nd[v].first=nd[i].first+hed[i][j].second.first,nd[v].second=nd[i].second+hed[i][j].second.second;if(d[v]<=0){if(nd[v].first<=0&&nd[v].second<=0)return 0;if(nd[v].first<=0&&nd[v].second>0)return 1;if(nd[v].first>0&&nd[v].second<0)return 2;}update=1;fin=nd[v];}}}if(!update)return 3;if(fin.second>0)return 1;if(fin.second<0)return 2;}class YamanoteLine{public:LL howMany(int __n,vector<int>s1,vector<int>t1,vector<int>l1,vector<int>s2,vector<int>t2,vector<int>l2){n=__n;LL l=0,r=(1LL<<50),tmp=r+1;for(LL mid;l<=r;){mid=l+r>>1;int sig=calc(mid,s1,t1,l1,s2,t2,l2);if(!sig)return 0;if(sig==3){tmp=mid,l=mid+1;continue;}if(sig==1)l=mid+1;else r=mid-1;}if(tmp==(1LL<<50)+1)return 0;l=0,r=(1LL<<50);LL dow=-1;for(LL mid;l<=r;){mid=l+r>>1;int sig=calc(mid,s1,t1,l1,s2,t2,l2);if(!sig)return 0;if(sig==3){dow=mid,r=mid-1;continue;}if(sig==1)l=mid+1;else r=mid-1;}if(dow==-1)return 0;if(!dow||tmp==(1LL<<50))return-1;return tmp-dow+1;}};