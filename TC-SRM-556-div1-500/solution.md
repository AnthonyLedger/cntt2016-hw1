# LeftRightDigitsGame2

作者：陈通

关键词：动态规划 记忆化搜索

## 试题来源

Topcoder SRM 556 Div1 500



## 试题大意

你现在有一叠纸牌，共$$n$$张，用$$digits$$表示，每张纸牌上写有一个数字。你每次取出牌堆顶部的第一张牌，把它放在桌子上。从第二张牌开始，你每次必须把牌放在桌上已有纸牌的最左侧或最右侧。最终这$$n$$张牌组成了一个$$n$$位数。现在给定一个$$n$$位数$$lowerBound$$，希望你求出大于等于$$lowerBound$$的可能结果中最小的一个$$n$$位数。

$$1 \leq n \leq 50$$



## 算法介绍

我们可以发现，牌堆顶部的连续$$i$$张牌，在这个$$n$$位数中也一定是连续的$$i$$位。我们对操作逆向考虑。每次对于牌堆底部的每一张牌，考虑放在左侧还是放在右侧。若我们已知前$$i$$张牌在$$n$$位数中所对应的区间，当我们决定了第$$i$$张牌的位置，那么我们就可以确定前$$i-1$$张牌的区间了。

定义状态$$f[i][j][s1][s2]$$，表示所求n位数中$$[1, i - 1]$$位组成的数与$$lowerBound$$中$$[1, i - 1]$$位组成的数的大小关系为$$s1$$，所求n位数中$$[j+1, n]$$位组成的数与$$lowerBound$$中$$[j+1, n]$$位组成的数的大小关系为$$s2$$，用牌堆中前$$j - i + 1$$张牌，放在$$[i, j]$$的位置上所组成最小的$$j - i + 1$$位数，满足所组成的$$n$$位数与$$lowerBound$$的大小关系满足题意。其中$$s1$$和$$s2$$用$$0, 1, 2$$分别表示小于、等于和大于关系。所求即为$$f[1][n][1][1]$$。对于状态$$f[i][j][s1][s2]$$，分别枚举第$$j - i + 1$$放在位置$$i$$和位置$$j$$两种情况，对于每种情况求出新的大小关系$$s1'$$和$$s2'$$，$$f[i][j][s1][s2]$$可以根据$$f[i + 1][j][s1'][s2]$$和$$f[i][j - 1][s1][s2']$$求出。当$$i = j$$时，我们很容易判断当前状态是否满足题意，若不满足题意则进行标记，否则该状态为牌堆第一张牌所写数字。

状态总数为$$n^2 \cdot 3^2$$。每个状态转移时，字符串比较和赋值的时间复杂度为$$O(n)$$。总时间复杂度为$$O(n^3)$$。
