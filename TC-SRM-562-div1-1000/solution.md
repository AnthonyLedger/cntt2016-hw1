# InducedSubgraphs
作者：汪乐平

关键词：计数 分情况讨论 动态规划

## 题目简述

给一棵$$n$$个结点的树，再给一个整数$$k$$，将其结点重新编号，使得对于任意一个满足$$1\leq i\leq n-k+1$$的$$i$$，都满足以编号在$$[i,i+k-1]$$内的结点为点集的导出子图是一个连通图。问这样的编号方式有多少种。$$1\leq k\leq n\leq 40$$。

## 算法一

枚举编号方式，直接检验即可。时间复杂度$$O(n^2.n!)$$。

## 算法二

换一种方法判断是否是凸四边形。假设已知一个黑点和两个白点，显然另一个黑点在下图所示的深色区域时这个四边形才是凸的。

考虑这个深色区域中的点有什么性质。设数组$$b[i][j][k]$$表示$$\angle ikj$$是否小于$$\pi $$（这里认为$$\angle ikj+\angle jki=2\pi $$）。假设已知的两个白点是$$w1$$和$$w2$$，黑点是$$b1$$，那么深色区域中的点$$x$$就满足$$b[w1][b1][x]\oplus b[w2][b1][x]=1$$且$$b[w1][w2][x]\oplus b[w1][w2][b1]=1$$。所以预处理出$$b$$，枚举$$w1,w2,b1,x$$就可以判断有没有符合条件的凸四边形了。

如果暴力枚举时间复杂度仍然是$$O(W^2B^2)$$的，但这种判断方法可以用$$bitset$$压位加速，所以判断的时间可以降为$$O(W^2B^2/w)$$，其中$$w$$表示字长。数组$$b$$三维的大小分别为$$W$$、$$W+B$$、$$B$$，求$$b[i][j][k]$$的值可以用叉积$$O(1)$$计算，所以预处理$$b$$的时间复杂度为$$O((W+B)WB)$$。所以总的时间复杂度为$$O((W+B+WB/w)WB)$$。