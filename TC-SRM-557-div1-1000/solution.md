# XorAndSum
作者：赵晟宇

关键词：线性基 高斯消元

## 题目简述
给定一个长度为$$n$$的整数序列$$number_i (0 \leq i < n)$$。每次操作选择两个整数$$i, j (0 \leq i, j < n; i \neq j)$$，将$$number_i$$修改为$$number_i$$与$$number_j$$的二进制异或，而$$number_j$$不变。不限操作次数，求序列中所有数之和的最大值。

$$1 \leq n \leq 50$$
$$0 \leq number_i \leq 10^{15}$$

## 算法
若我们求出一组异或线性基（线性基的定义这里就不重述了），那么线性基内部可以构造出一个最大值，线性基外的每个数亦可在归$$0$$之后同样变成这个最大值。所以我们首先用高斯消元求出序列的异或线性基，并保证每列（每个二进制位）最多包含一个$$1$$。这时把所有的数异或起来即可得到最大值，因为只有那些没有$$1$$的列异或之后的结果是$$0$$，而这些列无论怎样操作也不可能出现$$1$$。我们选择最高位为$$1$$的数，把它与其它的每个数异或，操作成最大值。然后，将其它的每个数与这个最大值异或，可以证明这样得到的序列即为最优序列。

我们下面来证明这个算法的正确性。

容易发现，题目中的操作是可逆的。即，无论如何都可以再通过若干次操作使其恢复初始状态（翻转操作序列即可）。

对于线性基中除最高位外存在$$1$$的每一列，答案序列在该列上有且仅有一个$$0$$。现在用反证法来说明，对于线性基中除最高位外存在$$1$$的第$$i$$列，均至少有一个$$0$$。若第$$i$$列上没有$$0$$，即全是$$1$$，则答案序列中的每个数的最高位与第$$i$$位都是相同的。不论再经过多少次操作，显然序列中每个数的最高位与第$$i$$位仍都是相同的。而由于操作是可逆的，与线性基中的解矛盾，这样的答案序列无法恢复成初始序列。

算法得证。

时间复杂度$$O(n^2)$$，空间复杂度$$O(n)$$。